---
import { useTranslations } from '../i18n/utils'
import {
  IconLogo,
  IconLogoLight,
  IconLanguage,
  IconMoon,
  IconSun
} from './icons/icons'

const { currentLocale = 'es' } = Astro

const t = useTranslations(currentLocale)

const changeLang = currentLocale === 'en' ? '' : 'en'
---

<script>
  const btnSwitchTheme = document.querySelector('[btn-switch-theme]')
  const html = document.querySelector('html')
  const header = document.querySelector('#header')
  const ls = localStorage
  const d = document

  const setThemeDark = () => {
    html.setAttribute('data-theme', 'dark')
    html.classList.add('dark')
    header.setAttribute('data-theme', 'dark')
  }

  const setThemeLight = () => {
    html.setAttribute('data-theme', 'light')
    html.classList.remove('dark')
    header.setAttribute('data-theme', 'light')
  }

  const changeColor = () => {
    if (html.getAttribute('data-theme') === 'light') {
      setThemeDark()
    } else {
      setThemeLight()
    }
  }

  const lsLoader = () => {
    if (ls.getItem('darkMode-portafolio-andino') == 'true') {
      setThemeDark()
    } else {
      setThemeLight()
    }
  }

  btnSwitchTheme.addEventListener('click', () => {
    changeColor()
    ls.setItem(
      'darkMode-portafolio-andino',
      html.classList.contains('dark') ? 'true' : 'false'
    )
  })

  d.addEventListener('DOMContentLoaded', () => {
    lsLoader()
  })
</script>

<header class='header' data-theme='light' id='header'>
  <a href='#' class='header__logo'>
    <IconLogo />
    <IconLogoLight />
  </a>
  <nav class='header__nav'>
    <ul class='nav__lists'>
      <li class='list'><a href='#'>{t('nav.home')}</a></li>
      <li class='list'><a href='#'>{t('nav.skills')}</a></li>
      <li class='list'><a href='#'>{t('nav.projects')}</a></li>
      <li class='list'><a href='#'>{t('nav.contact')}</a></li>
    </ul>
  </nav>
  <div class='header__utils'>
    <a href={`/${changeLang}`} class='utils__button'>
      <IconLanguage />
    </a>
    <button class='utils__button' btn-switch-theme>
      <IconMoon />
      <IconSun />
    </button>
  </div>
</header>

<style>
  .header {
    width: 100%;
    height: 100px;
    background: transparent;

    position: sticky;
    top: 0;

    display: flex;
    justify-content: space-between;
    align-items: center;

    animation: fadeOut linear both;
    animation-timeline: scroll();
    animation-range: 0 300px;
  }

  @keyframes fadeOut {
    to {
      opacity: 0;
      top: -100px;
      backdrop-filter: blur(5px);
    }
  }

  .header__logo,
  .header__utils {
    width: 20%;
    min-width: 100px;
    height: 100%;
    display: flex;
    align-items: center;
  }

  .header__logo {
    justify-content: flex-start;
  }

  .header__utils {
    justify-content: flex-end;
    gap: 10px;
  }

  .header__nav {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .nav__lists {
    width: 100%;
    display: flex;
    justify-content: space-around;
    align-items: center;
  }

  .list {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .list a {
    text-decoration: none;
    color: var(--white);
    font-size: var(--step-0);
    font-weight: 400;
  }

  .list a:after {
    content: '';
    display: block;
    width: 0;
    height: 2px;
    background: var(--sky-blue);
    transition: width 0.2s;
  }

  .list a:hover:after {
    width: 100%;
    box-shadow: var(--shadow-elevation-high);
  }

  .utils__button {
    color: var(--white);
    cursor: pointer;
    background-color: transparent;
    border: none;
    display: grid;
    place-items: center;
  }

  .utils__button::after {
    content: '';
    display: block;
    width: 0;
    height: 2px;
    background: var(--sky-blue);
    transition: width 0.3s;
  }

  .utils__button:hover::after {
    width: 100%;
    box-shadow: var(--shadow-elevation-high);
  }

  .utils__button:hover {
    box-shadow: var(--shadow-elevation-medium);
    transition: all 0.6s;
  }

  [data-theme='dark'] {
    .icon-sun {
      display: none;
    }

    .logo-light {
      display: none;
    }
  }

  [data-theme='light'] {
    .icon-moon {
      display: none;
    }

    .logo-dark {
      display: none;
    }
  }
</style>
